
{extend name="common/header" /}
{block name="headers"}
<title>我的收藏</title>
<link rel="stylesheet" href="__HOME__/css/publicSI.css" />
<link rel="stylesheet" href="__HOME__/css/collect.css" />
{/block}
{block name="main"}

		<div id="home">
			<div class="pHead">
				<a href="person.html" class="back backP"><img src="__HOME__/img/back.png"/></a>
				<p>我的收藏</p>
			</div>
			<div class="video">
                {volist name="catids" id="vo" key="k"}
				<button href="###" v-on:click="changeCatid('{$vo.id}')" {if condition="$k eq 1"}class="tActive" disabled="disabled"{/if}>{$vo.catname}</button>
                {/volist}
				<span></span>
				<div class="clearl"></div>
			</div>

            <template v-if='searchResult.length>0'>

			<div class="hotQuestion">
				<div class="qusetionBox">
					<div class="qList">
                        <template v-for="(key,item) in searchResult">
						<a href="###" class="questionDetails">
							<div class="qdl floatl centerCenter">
                                <img src="__PUBLIC__{{item.thumb}}" />
							</div>
							<div class="qdr floatl">
								<ul>
									<li>
										<p>{{item.title}}</p>
									</li>
									<li>
										<p>{{item.date_num}}</p>
										<p>时间：{{item.createtime}}</p>
									</li>
								</ul>
							</div>
							<div class="clearl"></div>
						</a>
                        </template>

					</div>
				</div>
			</div>
            </template>
            <template v-else>
			<!--没有搜索结果-->
			<div class="noResult" >
				<ul>
					<li>
						<img src="__HOME__/img/noVideo.png" />
					</li>
					<li>
						<p style="margin-bottom: 0;">您没有收藏的视频</p>
					</li>
					<li>
						<a href="###" >查看视频</a>
					</li>
				</ul>			
			</div>
            </template>
		</div>

{/block}

{block name="footer"}
{include file="common/footer" /}
<script type="text/javascript" src="__HOME__/js/public.js" ></script>
<script type="text/javascript" src="__HOME__/js/collect.js" ></script>
<script type="text/javascript">
    var data={
        searchResult:[],
    };

    var all = new Vue({
        el:'#vueMain',
        data:data,
        created:function(){
            var $this=this;
            $this.searchResult=[];
            layui.use('flow', function(){
                var flow = layui.flow;
                flow.load({
                    elem: '#home'
                    ,done: function(page, next){
                        var lis = [];
                        $this.AjaxL('{:url("Collect/index")}','GET',{"page":page,"catid":27},function(res){
                            list=res.list;
                            if(list.length<=0){
                                $('.layui-flow-more').hide();
                                $('.noResult').show();
                            }else{
                                $('.layui-flow-more').show();
                                $('.noResult').hide();
                            }
                            for (x in list){
                                $this.searchResult.push(list[x]);
                            }
                            next('', page <= res.last_page);
                        });
                    }
                });
            });
        },
        methods: {
            AjaxL: function (url, type, data, call) {
                var $this = this;
                $.ajax({
                    type: type,
                    url: url,
                    data: data,
                    dataType: 'JSON',
                    success: function (res) {
                        call(res);
                        if (res.url) {
                            window.location.href = res.url;
                        }
                    },
                    error: function (XMLHttpRequest) {
                        console.log(1111);
                    }
                })
            },
            changeCatid:function(catid){
                var $this=this;
                $this.searchResult=[];
                layui.use('flow', function(){
                    var flow = layui.flow;
                    flow.load({
                        elem: '#home'
                        ,done: function(page, next){
                            var lis = [];
                            $this.AjaxL('{:url("Collect/index")}','GET',{"page":page,"catid":catid},function(res){
                                list=res.list;
                                if(list.length<=0){
                                    $('.layui-flow-more').hide();
                                    $('.noResult').show();
                                }else{
                                    $('.layui-flow-more').show();
                                    $('.noResult').hide();
                                }
                                for (x in list){
                                    $this.searchResult.push(list[x]);
                                }
                                next('', page <= res.last_page);
                            });
                        }
                    });
                });
            }
        }
    });
</script>
{/block}


